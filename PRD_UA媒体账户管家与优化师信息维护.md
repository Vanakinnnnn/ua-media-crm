# UA媒体账户管家与优化师信息维护 PRD

---

## 角色定位

你是一个经验丰富的UI设计工程师和前端开发者，擅长创建简洁、功能强大的CRM系统。现在，你需要开发一个在公司内部管理各个媒体平台广告投放账户的平台。需要维护各个主账户信息、负责投放的优化师的信息，以及记录操作日志等，详细需求描述如下。也请随着我们的交流，随时更新这篇PRD。

---

## 一、产品背景与目标

随着UA自动化流程逐步增多，当前媒体账户和优化师信息依赖人工维护，AM需手动通知中台开发更新数据库，存在时效性差、透明度低、人员流动导致数据滞后等问题。涉及媒体包括Unity、Applovin、TikTok、Facebook、Google Ads等。

**目标**：
- 在HBG创建一个自动化界面，统一管理投放账户、媒体主体与优化师的信息，实现信息自动化同步。
- 提升信息更新的便捷性和工作效率，减少离线数据带来的中台数据滞后信息断层。
- 支持批量导入、权限映射、日志追溯、数据同步与备份。

---

## 二、用户角色
- **AM**：负责信息录入、更新、提交刷新申请。
- **中台**：接收数据更新通知，执行数据同步。
- **管理员**：可追溯操作日志，管理权限。

---

## 三、产品结构与页面导航

### 3.1 当前可见模块
1. **媒体信息管理** - 媒体账户列表页、新增/编辑媒体账户弹窗、Google子MCC管理对话框
2. **优化师信息管理** - 优化师列表页、新增/编辑优化师弹窗
3. **产品组管理** - 业务信息管理页面、通知管理页面
4. **操作日志** - 日志列表页

### 3.2 隐藏模块（本期暂不开发）
- **账户权限管理** - 权限矩阵页面、权限审计页面

### 3.3 全局操作
- **顶部导航栏** - 页面切换、刷新、退出登录等

---

## 四、功能模块与页面说明

### 4.1 媒体信息管理

#### 4.1.1 媒体账户列表页

**核心功能**：
- 展示所有媒体账户的关键信息（媒体类型、主账户ID、部门、状态、上次更新时间等）
- 支持多条件筛选（媒体类型、部门、状态等）
- 支持关键字搜索（账户名、ID等）
- 支持分页浏览
- 支持"新增媒体账户"按钮，弹出新增表单
- 每行支持"编辑"操作，弹出编辑表单
- 支持"申请刷新"操作，触发数据同步

**字段说明**：
- 媒体类型（下拉选择：Google Ads、Facebook、TikTok、Unity、Applovin、Moloco等）
- 主账户名/ID（必填，唯一性校验）
- 部门（多选标签，支持自定义）
- 账户配置（如MCC类型、Payment profile ID等，按媒体类型动态展示）
- 状态（自动/手动维护，active/closed）
- 上次信息更新时间（系统自动记录）

**媒体平台配置表**：
| 媒体         | 包含信息                                 | 编辑权限                                    |
| ------------ | ---------------------------------------- | ---------------------------------------- |
| Google Ads   | MCC类型（主/子MCC)、Payment profile ID | 主MCC仅可编辑Payment Profile ID；子MCC不可编辑配置 |
| Facebook     | 显示"-"（无配置项）                                     | 无配置项可编辑                                          |
| Tiktok       | Industry ID、Business Type、Billing Group ID | BC账户可编辑所有配置项        |
| Applovin     | 显示"-"（无配置项）                                     | 无配置项可编辑                                          |
| Unity        | 显示"-"（无配置项）                                     | 无配置项可编辑                                          |
| Moloco       | 显示"-"（无配置项）                                     | 无配置项可编辑                                          |

- FG信息：DH ID、环境（完全只读，不可编辑）
- 状态、上次信息更新时间

#### 4.1.2 媒体账户编辑权限控制

为确保数据安全性和业务逻辑正确性，系统对不同媒体平台和账户类型实施精细化的编辑权限控制：

**权限控制总表**：
| 平台类型 | 账户信息(名称/ID) | 部门 | 状态 | 账户配置 | FG信息(DHID/ENV) |
|---------|------------------|------|------|----------|-------------------|
| **Google主MCC** | ❌ 不可编辑 | ❌ 由子账户决定 | ❌ 不可编辑 | ✅ 仅Payment Profile ID | ❌ 完全只读 |
| **Google子MCC** | ✅ 可编辑 | ✅ 可编辑 | ✅ 可编辑 | ❌ 继承主MCC | ❌ 完全只读 |
| **TikTok BC** | ❌ 不可编辑 | ✅ 可编辑 | ❌ 不可编辑 | ✅ 全部配置项 | ❌ 完全只读 |
| **Facebook** | ❌ 不可编辑 | ✅ 可编辑 | ❌ 不可编辑 | ❌ 显示"-" | ❌ 完全只读 |
| **Unity** | ❌ 不可编辑 | ✅ 可编辑 | ❌ 不可编辑 | ❌ 显示"-" | ❌ 完全只读 |
| **AppLovin** | ❌ 不可编辑 | ✅ 可编辑 | ❌ 不可编辑 | ❌ 显示"-" | ❌ 完全只读 |
| **Moloco** | ❌ 不可编辑 | ✅ 可编辑 | ❌ 不可编辑 | ❌ 显示"-" | ❌ 完全只读 |

**详细权限说明**：

**Google Ads平台**：
- **主MCC账户**：
  - 账户信息：账户名称和ID均不可编辑（保持主账户信息稳定性）
  - 部门：不可编辑，系统自动汇总其所有子账户的部门信息
  - 状态：不可编辑（主账户状态由系统维护）
  - 账户配置：仅允许编辑Payment Profile ID，MCC Type不可更改
  - FG信息：DHID和Environment完全只读
- **子MCC账户**：
  - 账户信息：可编辑账户名称和账户ID
  - 部门：可编辑，支持多选
  - 状态：可编辑（Active/Closed）
  - 账户配置：Payment Profile ID继承主账户不可编辑，MCC Type不可更改
  - FG信息：DHID和Environment完全只读

**TikTok平台（BC账户）**：
- 账户信息：不可编辑（保持API数据一致性）
- 部门：可编辑，支持多选
- 状态：不可编辑（由API数据决定）
- 账户配置：可编辑Industry ID、Business Type、Billing Group ID
- FG信息：DHID和Environment完全只读

**Facebook平台**：
- 账户信息：不可编辑（保持API数据一致性）
- 部门：可编辑，这是唯一可修改的字段
- 状态：不可编辑（由API数据决定）
- 账户配置：列显示为空("-")，无配置项可编辑
- FG信息：DHID和Environment完全只读

**Unity平台**：
- 账户信息：不可编辑（保持数据一致性）
- 部门：可编辑，这是唯一可修改的字段
- 状态：不可编辑
- 账户配置：列显示为空("-")，无配置项可编辑
- FG信息：DHID和Environment完全只读

**AppLovin平台**：
- 账户信息：不可编辑（保持数据一致性）
- 部门：可编辑，这是唯一可修改的字段
- 状态：不可编辑
- 账户配置：列显示为空("-")，无配置项可编辑
- FG信息：DHID和Environment完全只读

**Moloco平台**：
- 账户信息：不可编辑（保持数据一致性）
- 部门：可编辑，这是唯一可修改的字段
- 状态：不可编辑
- 账户配置：列显示为空("-")，无配置项可编辑
- FG信息：DHID和Environment完全只读

**业务逻辑说明**：
1. **继承关系**：Google Ads子账户的Payment Profile ID、DHID、Environment继承主账户
2. **部门汇总**：Google Ads主账户部门为其所有子账户部门的并集
3. **数据一致性**：除Google Ads外的所有平台账户信息和状态保持只读，确保数据一致性
4. **配置管理**：仅TikTok平台支持账户配置编辑，其他平台配置列显示为空
5. **安全性**：FG信息作为系统集成关键字段，全平台禁止手动编辑

#### 4.1.3 Google子MCC管理功能

**功能定位**：为Google Ads主MCC账户提供子MCC的创建和管理功能

**触发方式**：
- **入口位置**：每个Google主MCC账户的"操作"列
- **触发按钮**：绿色用户图标按钮，悬停显示"管理子MCC"
- **权限控制**：仅在Google主MCC账户行显示，子MCC账户无此按钮

**添加子MCC对话框功能**：
- **对话框标题**："添加Google子MCC"
- **主MCC信息展示**：
  - 蓝色背景信息卡片显示正在操作的主MCC账户信息
  - 显示主MCC名称和账户ID
  - 信息只读，不可编辑
- **用户输入字段**：
  - **子MCC名称**：必填项，用户自定义输入
  - **子MCC账户ID**：必填项，用户输入唯一账户标识
  - **部门选择**：必填项，多选checkbox形式，支持选择多个部门
- **数据继承规则**：
  - Payment Profile ID：自动继承主MCC的设置
  - DHID和Environment：自动继承主MCC的FG信息
  - 状态：默认设置为"Active"
  - MCC类型：自动设置为"sub"

**表单验证规则**：
- **必填项检查**：子MCC名称、账户ID、部门至少选择一个
- **提交按钮状态**：未满足必填项时按钮禁用，满足条件时启用
- **账户ID唯一性**：系统应检查账户ID的唯一性（实际实现中可添加）

**交互流程**：
1. 用户点击主MCC行的"管理子MCC"按钮
2. 弹出添加子MCC对话框
3. 系统自动显示当前主MCC的账户信息
4. 用户填写子MCC的基本信息和选择部门
5. 点击"确认提交"创建子MCC账户
6. 新建的子MCC账户立即显示在主MCC下方
7. 对话框关闭，表单重置

#### 4.1.4 Google Ads主子账户平铺展示与筛选联动

- Google Ads账户在列表中主账户和子账户平铺展示，主账户永远在其子账户之上。
- 无论筛选条件如何，若筛选结果包含子账户，则自动展示其主账户（主子账户成对展示）。
- 采用边框包围的视觉设计：每个主账户组用蓝色边框包围，主账户使用浅蓝背景突出显示。
- MCC Type字段采用醒目的彩色标签样式：主MCC为蓝色背景，子MCC为绿色背景。
- 账户配置中不显示"主MCC ID"字段（主账户和子账户均不显示）。
- 其他平台账户展示方式不变。

#### 4.1.5 筛选器与搜索功能

**筛选器组件**：
1. **状态筛选**：下拉单选（全部、Active、Closed）
2. **媒体类型筛选**：自定义下拉多选组件
   - 支持展开菜单、对号选中标识
   - 选中项以蓝色标签形式显示在输入框内
   - 支持全选/全不选功能
   - 支持点击标签内×删除单个项目
   - 选项：Facebook、Google Ads、TikTok、Applovin、Unity、Moloco
3. **部门筛选**：自定义下拉多选组件（功能同媒体类型筛选器）
   - 选项：010、045、055、060、919

**综合搜索功能**：
- **搜索范围**：精准关键词匹配以下账户信息字段
  - 基本信息：账户名称、账户ID、公司名称
  - 账户配置：Payment Profile ID、MCC类型
  - 媒体特定字段：Industry ID、Business Type、Billing Group ID
  - FG信息：DHID、Environment
  - 注意：主MCC ID不参与常规搜索，有专门的精准匹配逻辑
- **不参与搜索的字段**：账户状态、媒体类型、部门（这些有专门的筛选器）
- **高亮显示**：匹配的关键词用黄色背景高亮标识
- **搜索逻辑**：
  - 支持子账户ID搜索（如搜索"SUB-001"可找到Gaming Division）
  - 主MCC ID精准匹配逻辑：当搜索关键词与某个主MCC的账户ID精准匹配时，自动展示该主MCC下的所有子账户（子账户仍受其他筛选条件如状态、媒体类型、部门等限制）

**筛选器交互流程**：
1. **输入阶段**：用户在各筛选器中输入/选择条件，此时不立即应用筛选
2. **手动触发**：点击"筛选"按钮后才应用所有筛选条件
3. **状态反馈**：应用筛选后显示当前生效的筛选条件标签
   - 状态筛选：绿色标签
   - 媒体类型：蓝色标签  
   - 部门筛选：紫色标签
   - 搜索关键词：黄色标签
4. **重置功能**：点击"重置"按钮清空所有筛选条件（包括用户输入和已应用的筛选）

**筛选器技术特性**：
- **双状态管理**：临时状态（用户输入）+ 应用状态（实际筛选）
- **组合筛选**：所有筛选条件使用AND逻辑组合
- **性能优化**：仅在点击筛选按钮时重新计算筛选结果
- **Google Ads特殊处理**：筛选结果包含子账户时自动补充其主账户（主子账户成对展示）
- **用户体验**：清晰的视觉反馈，避免输入过程中表格内容频繁变化

---

### 4.2 优化师信息管理

#### 4.2.1 优化师列表页

**核心功能**：
- 展示所有优化师的关键信息（姓名、邮箱、部门、媒体权限、状态、上次更新时间等）
- 支持多条件筛选（部门、状态、媒体类型等）
- 支持关键字搜索（姓名、邮箱等）
- 支持分页浏览
- 支持"新增优化师"按钮，弹出新增表单
- 每行支持"编辑"操作，弹出编辑表单
- 支持"申请刷新"操作

**字段说明**：
- 优化师姓名（必填，唯一性校验）
- 工作邮箱（必填，邮箱格式校验）
- 部门（多选标签）
- 媒体权限（可添加多个媒体账号，支持Facebook、TikTok、Google Ads等，每个媒体账号下有账号/ID等字段）
- 培训平台账号邮箱（选填）
- 状态（active/closed）
- 上次更新时间（系统自动记录）

#### 4.2.2 优化师管理界面升级

**重大功能调整**：
1. **界面模式转变**：从可编辑模式转为只读展示模式
2. **按钮移除**：删除"批量导入"和"添加优化师"功能按钮
3. **部门字段重构**：单一部门字段分拆为组织部门和权限部门
4. **媒体权限升级**：新增账户管家和Facebook用户ID字段

**列结构重新设计**：
| 原字段 | 新字段 | 变更说明 |
|--------|--------|----------|
| 部门 | 组织部门 + 权限部门 | 分拆为两列，明确区分归属与权限 |
| 媒体权限 | 媒体权限（升级） | 新增账户管家、Facebook用户ID字段 |
| 操作 | 只读提示 | 移除编辑功能，显示只读状态 |

**数据模型升级**：
- **Optimizer接口**：`department` → `organizationDepartment` + `permissionDepartments`
- **MediaPermission接口**：新增 `accountManager` 和 `facebookUserId` 字段

**字段说明**：
- **优化师姓名**：不可编辑，系统维护
- **工作邮箱**：不可编辑，系统维护
- **组织部门**：用户实际所属的部门，唯一
- **权限部门**：用户拥有优化师权限的部门，可能有多个
- **媒体权限**：可编辑，包含账户管家和Facebook用户ID
- **培训平台邮箱**：可编辑，默认使用优化师主邮箱
- **状态**：可编辑（active/closed）

#### 4.2.3 优化师管理筛选器系统

**筛选器组件规范**：
1. **搜索功能**：
   - **搜索范围**：优化师基本信息（姓名、邮箱、内部邮箱、外部邮箱、培训邮箱、职位）+ 媒体权限详情（平台、账户管家、媒体邮箱、Facebook用户ID）
   - **高亮显示**：匹配关键词以黄色背景高亮（bg-yellow-200）
   - **自动展开**：搜索结果包含媒体权限内容时，自动展开相关权限卡片
   - **占位符**："搜索优化师信息、账户管家、邮箱..."

2. **组织部门筛选器**：
   - **组件类型**：MultiSelect多选下拉组件
   - **选项**：010、045、055、060、919
   - **筛选逻辑**：精确匹配优化师的organizationDepartment字段
   - **标签颜色**：蓝色标签（bg-blue-100 text-blue-800）

3. **权限部门筛选器**：
   - **组件类型**：MultiSelect多选下拉组件
   - **选项**：010、045、055、060、919
   - **筛选逻辑**：优化师的permissionDepartments数组包含任一选中部门
   - **标签颜色**：绿色标签（bg-green-100 text-green-800）

4. **状态筛选器**：
   - **组件类型**：单选下拉选择器
   - **选项**：全部、Active、Closed
   - **筛选逻辑**：精确匹配优化师状态
   - **标签颜色**：紫色标签（bg-purple-100 text-purple-800）

5. **媒体类型筛选器**：
   - **组件类型**：MultiSelect多选下拉组件
   - **选项**：Google Ads、Facebook、TikTok、AppLovin、Unity、Moloco
   - **筛选逻辑**：优化师的mediaPermissions数组包含任一选中平台
   - **计数显示**：当筛选生效时，媒体权限列显示格式"媒体权限 (过滤数/总数)"
   - **标签颜色**：橙色标签（bg-orange-100 text-orange-800）

**筛选器交互流程**：
1. **输入阶段**：用户在各筛选器中输入/选择条件，此时不立即应用筛选
2. **手动触发**：点击"筛选"按钮后才应用所有筛选条件
3. **状态反馈**：应用筛选后显示当前生效的筛选条件标签
4. **重置功能**：点击"重置"按钮清空所有筛选条件和搜索内容

**媒体权限过滤显示逻辑**：
- **正常显示**：媒体权限 (3) - 显示所有权限数量
- **筛选显示**：媒体权限 (2/3) - 显示过滤后数量/总数量
- **权限内容**：仅显示符合媒体类型筛选条件的权限详情
- **平台分组**：过滤后的权限按平台重新分组展示

**搜索高亮规范**：
- **高亮样式**：黄色背景 + 圆角（bg-yellow-200 px-1 rounded）
- **高亮范围**：优化师姓名、邮箱、培训邮箱、账户管家、媒体邮箱、Facebook用户ID
- **自动展开**：搜索匹配媒体权限内容时，自动展开折叠的权限卡片
- **忽略大小写**：搜索匹配不区分大小写

**筛选器布局设计**：
- **第一行**：搜索框、组织部门、权限部门、状态（4列网格布局）
- **第二行**：媒体类型、操作按钮（筛选/重置）（3列网格布局）
- **第三行**：当前筛选条件标签（条件性显示）
- **响应式**：移动端自动调整为单列布局

---

### 4.3 产品组管理

#### 4.3.1 产品组管理概述
产品组管理模块用于维护各产品组的业务信息和通知配置。产品组为固定值，包括：F10、F45、F55、F60、F75、F89、F919、F41、F42、F35、UGC。

#### 4.3.2 业务信息管理

**功能特性**：
- **产品组展示**：固定显示11个产品组，不可修改
- **Facebook配置**：时区设置，支持编辑
- **Google配置**：时区设置，支持编辑
- **TikTok配置**：Promotion Link、Industry ID、时区，支持编辑
- **行内编辑**：点击编辑按钮进入编辑模式，支持保存和取消操作

**字段说明**：
- **产品组**：显示产品组代码（如F10、UGC），只读
- **Facebook**：时区配置，支持编辑
- **Google**：时区配置，支持编辑
- **TikTok**：包含三个字段
  - Promotion Link：TikTok推广链接，支持编辑
  - Industry ID：TikTok行业ID，支持编辑
  - 时区：时区设置，支持编辑

**交互规范**：
- **编辑模式**：点击编辑按钮进入编辑状态，显示保存和取消按钮
- **保存操作**：点击保存按钮保存修改，退出编辑模式
- **取消操作**：点击取消按钮放弃修改，退出编辑模式
- **输入验证**：支持任意字符串输入，无特殊格式要求
- **多字段编辑**：TikTok列包含三个输入框，支持同时编辑多个字段

#### 4.3.3 通知管理

**功能特性**：
- **角色定义列**：增长负责人、巴长列用于维护此产品组此角色的邮箱
- **智能列编辑**：支持单选列（覆盖模式）和多选列（追加模式）
- **状态反映**：列编辑状态准确反映整列实际情况
- **图标显示**：角色用图标显示，邮箱用文本显示

**字段说明**：
- **审批AM**：支持多个邮箱，可手动输入或选择角色
- **增长负责人**：支持多个邮箱，可手动输入或选择角色
- **开户申请审批人**：单个邮箱，支持手动输入或选择角色
- **权限申请审批人**：单个邮箱，支持手动输入或选择角色
- **余额不足通知人**：多个邮箱，支持手动输入或选择角色
- **余额不足通知频道**：单个频道名称，仅支持手动输入

**列编辑功能**：
- **单选列**（开户申请审批人、权限申请审批人）：只能选择增长负责人，会覆盖现有内容
- **多选列**（审批AM、余额不足通知人）：可以同时选择增长负责人，追加到现有列表，支持取消勾选删除
- **列编辑按钮**：列名旁设置图标按钮，点击打开编辑弹窗
- **状态反映**：列编辑弹窗会检查整列中是否所有行都包含增长负责人，只有当所有行都包含该角色时，对应的复选框才会被勾选

**单元格编辑功能**：
- **多选单元格**：显示已选邮箱列表，支持删除单个邮箱
- **添加邮箱**：输入框 + 添加按钮，支持回车键快速添加
- **角色选择**：增长负责人按钮，点击快速添加对应角色邮箱
- **单选单元格**：单个输入框，支持手动输入或角色选择

**交互规范**：
- **编辑模式**：点击编辑按钮进入编辑状态
- **邮箱管理**：支持添加、删除、角色选择等多种操作
- **角色选择**：点击角色按钮自动添加对应产品组的角色邮箱
- **保存操作**：点击保存按钮保存所有修改
- **取消操作**：点击取消按钮放弃所有修改

#### 4.3.4 技术实现规范

**数据结构**：
- `ProductGroup`：产品组基础信息（id、name、code）
- `BusinessInfo`：业务信息（产品组、TikTok推广链接、TikTok行业ID）
- `NotificationConfig`：通知配置（产品组、各角色邮箱配置）

**组件架构**：
- `ProductGroupModule`：主模块，包含标签页切换
- `BusinessInfoTab`：业务信息管理标签页
- `NotificationTab`：通知管理标签页

**状态管理**：
- 编辑状态管理：当前编辑的产品组ID
- 编辑数据管理：编辑中的临时数据
- 列编辑状态：多选列的追加模式和单选列的覆盖模式

---

### 4.4 操作日志

#### 4.4.1 系统对象总结
基于系统架构分析，操作日志需要记录以下核心对象的操作：

**媒体账户管理模块对象**：
- `MediaPlatform`：媒体平台基础信息
- `MediaAccount`：媒体账户详细信息
- `DefaultSettings`：账户配置信息（MCC类型、Payment Profile ID等）
- `FGInfo`：FG信息（DHID、ENV等）

**优化师管理模块对象**：
- `Optimizer`：优化师基本信息（姓名、邮箱、部门等）
- `MediaPermission`：媒体权限配置（平台、账户管家、邮箱等）

**Facebook BM管理对象**：
- `FacebookBM`：Facebook Business Manager
- `FacebookAdAccount`：Facebook广告账户

**系统刷新操作对象**：
- `Refresh Request`：刷新请求（类型、目标对象）

#### 4.4.2 操作日志功能特性

**高级筛选系统**：
- **搜索筛选**：支持关键词搜索（操作描述、对象名称、操作用户）
- **模块筛选**：媒体信息、优化师管理、Facebook账户、系统管理
- **操作类型筛选**：新增、修改、删除、刷新、权限变更
- **对象类型筛选**：媒体平台、媒体账户、账户配置、FG信息、优化师、媒体权限、Facebook BM、Facebook广告账户
- **状态筛选**：成功、失败、待处理
- **用户筛选**：按操作用户筛选
- **日期范围筛选**：支持开始和结束日期选择

**日志展示功能**：
- **时间显示**：相对时间（刚刚、X小时前、X天前）+ 完整时间戳
- **用户信息**：操作用户ID和姓名
- **模块标识**：彩色标签显示所属模块
- **操作类型**：图标+文字标签，不同操作类型使用不同颜色
- **对象信息**：对象类型图标、对象名称、对象类型
- **操作描述**：详细的操作说明
- **状态显示**：彩色标签显示操作状态

**详情展开功能**：
- **行内展开**：点击展开按钮显示操作详情
- **基本信息**：操作ID、IP地址、操作时间
- **变更详情**：具体字段变更（原值vs新值）
- **完整对象信息**：操作前后的完整对象状态（JSON格式）
- **模态框详情**：点击查看详情按钮打开完整详情模态框

**数据导出功能**：
- **CSV导出**：支持筛选后的日志数据导出
- **文件命名**：操作日志_YYYY-MM-DD.csv
- **导出字段**：时间、用户、模块、操作、对象类型、对象名称、描述、状态、IP地址

#### 4.4.3 操作日志字段说明

**基础字段**：
- **操作ID**：唯一标识符
- **操作用户**：用户ID和姓名
- **操作类型**：create（新增）、update（修改）、delete（删除）、refresh（刷新）、permission_change（权限变更）
- **所属模块**：media（媒体信息）、optimizer（优化师管理）、facebook（Facebook账户）、system（系统管理）
- **对象类型**：具体的业务对象类型
- **对象ID**：操作对象的唯一标识
- **对象名称**：操作对象的显示名称
- **操作描述**：详细的操作说明
- **操作时间**：完整的时间戳
- **IP地址**：操作用户的IP地址
- **操作状态**：success（成功）、failed（失败）、pending（待处理）
- **错误信息**：操作失败时的错误详情

**变更详情字段**：
- **变更字段**：具体修改的字段名称
- **原值**：修改前的值
- **新值**：修改后的值

**对象详情字段**：
- **操作前状态**：操作前的完整对象信息
- **操作后状态**：操作后的完整对象信息

---

## 五、全局交互与体验

### 5.1 顶部导航栏（Header）功能规范

**系统标题与版本标识**：
- 主标题："UA媒体账户管家与优化师信息维护"
- 版本标识：绿色标签显示当前版本号（如"v1.0"）
- 位置：页面左上角

**功能说明**：
- 顶部导航栏仅显示系统标题和版本标识
- 全局搜索、通知、用户管理等功能已移除
- 界面更加简洁，专注于核心功能

### 5.2 侧边栏导航规范

**系统标题**：页面顶部显示"媒体信息管理系统"

**导航菜单**：
- 媒体信息（Monitor图标）
- 优化师管理（Users图标）
- 产品组管理（Package图标）
- 操作日志（Activity图标）

**选中状态**：蓝色背景，右侧箭头指示
**悬停效果**：灰色背景高亮

### 5.3 刷新申请弹窗规范

**功能特性**：
- **刷新类型**：下拉单选菜单，包含"账户管家"和"Facebook BM Client账户"
- **刷新对象**：
  - 账户管家：不可选，默认为"全部"
  - Facebook BM Client账户：可搜索下拉菜单，显示BM名称与BMID组合
- **提交按钮**：提交后显示成功提示，引导用户查看操作日志

**位置说明**：
- **申请刷新按钮**：位于"媒体信息管理"界面的右上角，与页面标题同行
- **其他界面**：不显示"申请刷新"按钮，保持界面简洁
- **功能范围**：刷新功能仅对媒体信息管理模块有效

**交互流程**：
1. 用户在"媒体信息管理"页面点击"申请刷新"按钮
2. 弹出刷新申请弹窗
3. 选择刷新类型和对象
4. 点击"提交申请"
5. 显示成功提示，引导查看操作日志

### 5.4 自定义多选组件技术规范

**MultiSelect组件功能特性**：
- **基础交互**：
  - 点击展开/收起下拉菜单
  - 点击选项前复选框进行选择/取消选择
  - 点击已选标签的×号删除单个选项
- **选中状态显示**：
  - 已选项以蓝色标签形式展示在输入框内
  - 下拉菜单中已选项显示蓝色对勾
- **批量操作**：
  - "全选"按钮：选择所有可选项
  - "清空"按钮：取消所有已选项
- **视觉设计**：
  - 输入框：白色背景，灰色边框，最小高度40px
  - 下拉菜单：白色背景，阴影效果，最大高度240px可滚动
  - 已选标签：蓝色背景(bg-blue-100)，蓝色文字(text-blue-800)
- **外部点击关闭**：点击组件外部区域自动关闭下拉菜单

### 5.5 确认对话框规范

**ConfirmDialog组件规范**：
- **触发场景**：敏感操作前的二次确认（如申请刷新）
- **视觉设计**：
  - 模态框：白色背景，圆角，居中显示
  - 遮罩层：黑色半透明背景(bg-black bg-opacity-50)
  - 警告图标：黄色警告三角形图标
- **内容结构**：
  - 标题：操作名称
  - 描述：详细的操作说明和影响
  - 按钮：取消(灰色) + 确认(蓝色)
- **交互行为**：
  - ESC键关闭
  - 点击遮罩层关闭
  - 点击取消或确认按钮关闭

---

## 六、技术实现规范

### 6.1 前端技术栈
- **框架**：React 18 + TypeScript
- **构建工具**：Vite
- **样式方案**：Tailwind CSS
- **图标库**：Lucide React
- **状态管理**：React Hooks (useState, useMemo, useEffect等)

### 6.2 组件架构规范
- **布局组件**：
  - `App.tsx`：主应用容器，管理模块切换和全局状态
  - `Header.tsx`：顶部导航栏组件
  - `Sidebar.tsx`：侧边栏导航组件
- **功能模块组件**：
  - `MediaModule.tsx`：媒体账户管理主组件
  - `OptimizerModule.tsx`：优化师管理主组件
  - `ProductGroupModule.tsx`：产品组管理主组件
  - `OperationLogs.tsx`：操作日志组件
- **通用组件**：
  - `MultiSelect.tsx`：自定义多选下拉组件
  - `ConfirmDialog.tsx`：确认对话框组件
  - `RefreshRequestDialog.tsx`：刷新申请弹窗组件
  - `PlatformLogo.tsx`：平台Logo组件

### 6.3 数据模型规范
- **接口定义**：所有数据类型定义在`src/types/index.ts`中
- **核心数据模型**：
  - `MediaAccount`：媒体账户信息
  - `Optimizer`：优化师信息
  - `ProductGroup`：产品组基础信息
  - `BusinessInfo`：业务信息
  - `NotificationConfig`：通知配置
  - `OperationLog`：操作日志
- **数据继承规则**：
  - Google Ads子账户继承主账户的Payment Profile ID、DHID、Environment
  - Google Ads主账户部门为所有子账户部门的并集

### 6.4 状态管理规范
- **双状态模式**：筛选器使用临时状态(tempFilters)和应用状态(appliedFilters)分离
- **展开状态**：使用Set数据结构管理多个可展开项的状态
- **加载状态**：所有异步操作都有对应的loading状态管理
- **错误处理**：统一的错误状态管理和用户反馈机制

### 6.5 响应式设计
- **断点设置**：遵循Tailwind CSS断点规范
- **布局适配**：侧边栏在移动端可收起，表格支持横向滚动
- **字体缩放**：支持不同屏幕尺寸的字体大小适配

---

## 七、典型用户场景
1. **AM批量导入新媒体账户**：通过"新增媒体账户"弹窗，批量填写主账户信息，选择部门，配置账户参数，提交后自动校验并入库。
2. **优化师权限变更**：在优化师列表页，筛选目标优化师，编辑其媒体权限，动态添加/删除媒体账号，保存后自动校验并同步。
3. **数据同步与刷新**：AM在任意页面点击"申请刷新"，系统自动同步最新数据到数据库，并在操作日志中记录本次操作。
4. **操作追溯**：管理员可在操作日志页，按时间/操作人/模块筛选，快速定位历史操作详情。
5. **产品组配置管理**：管理员在产品组管理页面，配置各产品组的业务信息和通知规则，支持角色管理和邮箱配置。

---

## 八、权限与安全
- 仅AM和中台有操作权限，普通用户只读
- 所有操作均需登录，支持单点登录（SSO）对接
- 敏感操作（如批量导入、刷新）需二次确认

---

## 九、数据同步与备份
- 支持每日定时自动同步
- 支持手动触发同步
- 所有数据变更均有备份和恢复机制

---

## 十、附录
- 页面原型与交互可参考：[https://lustrous-daffodil-e7d54b.netlify.app/](https://lustrous-daffodil-e7d54b.netlify.app/)
- 字段、交互、校验规则如有变动，以产品实际页面为准
